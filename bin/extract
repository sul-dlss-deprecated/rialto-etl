#!/usr/bin/env ruby
# frozen_string_literal: true

require 'bundler/setup'
require 'optparse'
require 'rialto/etl'

options = {}

OptionParser.new do |parser|
  parser.banner = 'Usage: bin/extract [options]'
  parser.on('-n', '--name NAME', 'Name of the extractor to run (REQUIRED)') do |value|
    options[:name] = value
  end
end.parse!

raise OptionParser::MissingArgument, '-n NAME' unless options[:name]

puts Rialto::Etl::Extractors.const_get(options[:name]).new.extract
